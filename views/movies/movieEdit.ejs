<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head.ejs') %>

  <body>
    <%- include('../partials/header.ejs') %>

    <main>
      <div class="form">
        <h1>Edit Movie</h1>
        <form action="/movieList/<%= movie._id %>?_method=PUT" method="POST">
          <label for="title">Title:</label>
          <input
            type="text"
            id="title"
            name="title"
            class="form__input"
            value="<%= movie.title %>"
          />

          <label for="description">Description:</label>
          <textarea
            id="description"
            name="description"
            class="form__input"
            value="<%= movie.description %>"
          ></textarea>

          <label for="director">Director:</label>
          <input
            type="text"
            id="director"
            name="director"
            class="form__input"
            value="<%= movie.director %>"
          />

          <label for="releaseDate">Release Date:</label>
          <input
            type="date"
            id="releaseDate"
            name="releaseDate"
            class="form__input"
            value="<%= movie.releaseDate %>"
          />

          <label for="genre">Genre:</label>
          <div class="genre__list">
            <div class="genre__div">
              <input
                type="text"
                id="genre"
                name="genre"
                class="form__input"
                value="<%= movie.genre %>"
              />
            </div>
          </div>
          <button type="button" class="form__submit" id="addGenreBtn">
            Add Genre
          </button>

          <label for="duration">Duration:</label>
          <input
            type="number"
            id="duration"
            name="duration"
            class="form__input"
            value="<%= movie.duration %>"
          />

          <label for="score">Score (1-10):</label>
          <select
            id="score"
            name="score"
            class="form__input"
            value="<%= movie.score %>"
          >
            <option disabled selected>Select Score</option>
            <option value="(10) Masterpiece">(10) Masterpiece</option>
            <option value="(9) Great">(9) Great</option>
            <option value="(8) Very Good">(8) Very Good</option>
            <option value="(7) Good">(7) Good</option>
            <option value="(6) Fine">(6) Fine</option>
            <option value="(5) Average">(5) Average</option>
            <option value="(4) Bad">(4) Bad</option>
            <option value="(3) Very Bad">(3) Very Bad</option>
            <option value="(2) Horrible">(2) Horrible</option>
            <option value="(1) Appalling">(1) Appalling</option>
          </select>

          <label for="coverImage">Cover Image:</label>
          <input
            type="file"
            id="coverImage"
            name="coverImage"
            class="form__file"
            accept="image/*"
            value="<%= movie.coverImage %>"
          />

          <button type="submit" class="form__submit">Update</button>
        </form>
      </div>
    </main>

    <%- include('../partials/footer.ejs') %>
    <script>
      const addGenreBtn = document.getElementById("addGenreBtn");
      const genreList = document.querySelector(".genre__list");
      const genreDiv = document.querySelectorAll(".genre__div")[0];

      addGenreBtn.addEventListener("click", () => {
        let newGenre = genreDiv.cloneNode(true);
        let input = newGenre.getElementsByTagName("input")[0];
        input.value = "";
        genreList.appendChild(newGenre);
      });
    </script>
  </body>
</html>
